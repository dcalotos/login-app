<div class="reset-password-container">
  <div class="reset-password-card">
    <h2>Reset Password</h2>

    <div *ngIf="checkingToken" class="checking-token">
      <p>Validating your reset link...</p>
    </div>

    <div *ngIf="!checkingToken && !tokenValid" class="alert alert-error">
      {{ errorMessage }}
      <div class="links" style="margin-top: 15px;">
        <a routerLink="/forgot-password">Request a new reset link</a>
      </div>
    </div>

    <div *ngIf="!checkingToken && tokenValid">
      <p class="subtitle">Enter your new password below.</p>

      <div *ngIf="successMessage" class="alert alert-success">
        {{ successMessage }}
        <p style="margin-top: 10px; font-size: 12px;">Redirecting to login...</p>
      </div>

      <div *ngIf="errorMessage" class="alert alert-error">
        {{ errorMessage }}
      </div>

      <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="newPassword">New Password</label>
          <input
            type="password"
            id="newPassword"
            formControlName="newPassword"
            placeholder="Enter new password"
            [class.invalid]="newPassword?.invalid && newPassword?.touched"
          />
          <div *ngIf="newPassword?.invalid && newPassword?.touched" class="error-message">
            <span *ngIf="newPassword?.errors?.['required']">Password is required</span>
            <span *ngIf="newPassword?.errors?.['minlength']">Password must be at least 8 characters</span>
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirm Password</label>
          <input
            type="password"
            id="confirmPassword"
            formControlName="confirmPassword"
            placeholder="Confirm new password"
            [class.invalid]="confirmPassword?.invalid && confirmPassword?.touched"
          />
          <div *ngIf="confirmPassword?.invalid && confirmPassword?.touched" class="error-message">
            <span *ngIf="confirmPassword?.errors?.['required']">Please confirm your password</span>
            <span *ngIf="confirmPassword?.errors?.['mismatch']">Passwords do not match</span>
          </div>
        </div>

        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="resetPasswordForm.invalid || isLoading"
        >
          <span *ngIf="!isLoading">Reset Password</span>
          <span *ngIf="isLoading">Resetting...</span>
        </button>
      </form>

      <div class="links">
        <a routerLink="/login">Back to Login</a>
      </div>
    </div>
  </div>
</div>
